OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:true,initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(m){if(!this.map||!this.checkModifiers(m)){return}var h=false;var d=false;var g=false;var b=OpenLayers.Event.element(m);while((b!=null)&&!g&&!h){if(!h){try{var c;if(b.currentStyle){c=b.currentStyle.overflow}else{var a=document.defaultView.getComputedStyle(b,null);c=a.getPropertyValue("overflow")}h=(c&&(c=="auto")||(c=="scroll"))}catch(f){}}if(!d){d=OpenLayers.Element.hasClass(b,"olScrollable");if(!d){for(var j=0,l=this.map.layers.length;j<l;j++){var k=this.map.layers[j];if(b==k.div||b==k.pane){d=true;break}}}}g=(b==this.map.div);b=b.parentNode}if(!h&&g){if(d){var o=0;if(m.wheelDelta){o=m.wheelDelta;if(o%160===0){o=o*0.75}o=o/120}else{if(m.detail){o=-(m.detail/Math.abs(m.detail))}}this.delta+=o;window.clearTimeout(this._timeoutId);if(this.interval&&Math.abs(this.delta)<this.maxDelta){var n=OpenLayers.Util.extend({},m);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(n)},this),this.interval)}else{this.wheelZoom(m)}}OpenLayers.Event.stop(m)}},wheelZoom:function(a){var b=this.delta;this.delta=0;if(b){a.xy=this.map.events.getMousePosition(a);if(b<0){this.callback("down",[a,this.cumulative?Math.max(-this.maxDelta,b):-1])}else{this.callback("up",[a,this.cumulative?Math.min(this.maxDelta,b):1])}}},activate:function(a){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",b);OpenLayers.Event.observe(window,"mousewheel",b);OpenLayers.Event.observe(document,"mousewheel",b);return true}else{return false}},deactivate:function(a){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var b=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",b);OpenLayers.Event.stopObserving(window,"mousewheel",b);OpenLayers.Event.stopObserving(document,"mousewheel",b);return true}else{return false}},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});