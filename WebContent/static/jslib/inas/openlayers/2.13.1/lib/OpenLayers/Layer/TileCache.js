OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,format:"image/png",serverResolutions:null,initialize:function(c,b,d,a){this.layername=d;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[c,b,{},a]);this.extension=this.format.split("/")[1].toLowerCase();this.extension=(this.extension=="jpg")?"jpeg":this.extension},clone:function(a){if(a==null){a=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())}a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a]);return a},getURL:function(b){var e=this.getServerResolution();var f=this.maxExtent;var j=this.tileSize;var a=Math.round((b.left-f.left)/(e*j.w));var i=Math.round((b.bottom-f.bottom)/(e*j.h));var g=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoom();var d=[this.layername,OpenLayers.Number.zeroPad(g,2),OpenLayers.Number.zeroPad(parseInt(a/1000000),3),OpenLayers.Number.zeroPad((parseInt(a/1000)%1000),3),OpenLayers.Number.zeroPad((parseInt(a)%1000),3),OpenLayers.Number.zeroPad(parseInt(i/1000000),3),OpenLayers.Number.zeroPad((parseInt(i/1000)%1000),3),OpenLayers.Number.zeroPad((parseInt(i)%1000),3)+"."+this.extension];var h=d.join("/");var c=this.url;if(OpenLayers.Util.isArray(c)){c=this.selectUrl(h,c)}c=(c.charAt(c.length-1)=="/")?c:c+"/";return c+h},CLASS_NAME:"OpenLayers.Layer.TileCache"});