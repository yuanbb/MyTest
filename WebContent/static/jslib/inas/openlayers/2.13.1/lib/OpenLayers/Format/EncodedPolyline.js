OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,{geometryType:"linestring",initialize:function(a){OpenLayers.Format.prototype.initialize.apply(this,[a])},read:function(g){var c;if(this.geometryType=="linestring"){c=OpenLayers.Geometry.LineString}else{if(this.geometryType=="linearring"){c=OpenLayers.Geometry.LinearRing}else{if(this.geometryType=="multipoint"){c=OpenLayers.Geometry.MultiPoint}else{if(this.geometryType!="point"&&this.geometryType!="polygon"){return null}}}}var f=this.decodeDeltas(g,2);var d=f.length;var b=[];for(var e=0;e+1<d;){var h=f[e++],a=f[e++];b.push(new OpenLayers.Geometry.Point(a,h))}if(this.geometryType=="point"){return new OpenLayers.Feature.Vector(b[0])}if(this.geometryType=="polygon"){return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(b)]))}return new OpenLayers.Feature.Vector(new c(b))},decode:function(c,j,f){var g=f||100000;var a=this.decodeDeltas(c,j,g);var b=a.length;var k=[];for(var d=0;d+(j-1)<b;){var h=[];for(var e=0;e<j;++e){h.push(a[d++])}k.push(h)}return k},write:function(b){var j;if(b.constructor==Array){j=b[0]}else{j=b}var h=j.geometry;var g=h.CLASS_NAME.split(".")[2].toLowerCase();var e;if(g=="point"){e=new Array(h)}else{if(g=="linestring"||g=="linearring"||g=="multipoint"){e=h.components}else{if(g=="polygon"){e=h.components[0].components}else{return null}}}var a=[];var c=e.length;for(var f=0;f<c;++f){var d=e[f];a.push(d.y);a.push(d.x)}return this.encodeDeltas(a,2)},encode:function(j,g,d){var e=d||100000;var a=[];var f=j.length;for(var b=0;b<f;++b){var h=j[b];for(var c=0;c<g;++c){a.push(h[c])}}return this.encodeDeltas(a,g,e)},encodeDeltas:function(l,a,e){var g=e||100000;var f;var k=new Array(a);for(f=0;f<a;++f){k[f]=0}var h=l.length;for(var b=0;b<h;){for(f=0;f<a;++f,++b){var c=l[b];var j=c-k[f];k[f]=c;l[b]=j}}return this.encodeFloats(l,g)},decodeDeltas:function(a,b,e){var g=e||100000;var f;var j=new Array(b);for(f=0;f<b;++f){j[f]=0}var k=this.decodeFloats(a,g);var h=k.length;for(var c=0;c<h;){for(f=0;f<b;++f,++c){j[f]+=k[c];k[c]=j[f]}}return k},encodeFloats:function(c,b){var e=b||100000;var a=c.length;for(var d=0;d<a;++d){c[d]=Math.round(c[d]*e)}return this.encodeSignedIntegers(c)},decodeFloats:function(f,c){var e=c||100000;var b=this.decodeSignedIntegers(f);var a=b.length;for(var d=0;d<a;++d){b[d]/=e}return b},encodeSignedIntegers:function(b){var a=b.length;for(var d=0;d<a;++d){var c=b[d];var e=c<<1;if(c<0){e=~(e)}b[d]=e}return this.encodeUnsignedIntegers(b)},decodeSignedIntegers:function(e){var b=this.decodeUnsignedIntegers(e);var a=b.length;for(var d=0;d<a;++d){var c=b[d];b[d]=(c&1)?~(c>>1):(c>>1)}return b},encodeUnsignedIntegers:function(b){var d="";var a=b.length;for(var c=0;c<a;++c){d+=this.encodeUnsignedInteger(b[c])}return d},decodeUnsignedIntegers:function(h){var d=[];var g=0;var c=0;var f=h.length;for(var e=0;e<f;++e){var a=h.charCodeAt(e)-63;g|=(a&31)<<c;if(a<32){d.push(g);g=0;c=0}else{c+=5}}return d},encodeFloat:function(b,a){b=Math.round(b*(a||100000));return this.encodeSignedInteger(b)},decodeFloat:function(c,b){var a=this.decodeSignedInteger(c);return a/(b||100000)},encodeSignedInteger:function(a){var b=a<<1;if(a<0){b=~(b)}return this.encodeUnsignedInteger(b)},decodeSignedInteger:function(b){var a=this.decodeUnsignedInteger(b);return((a&1)?~(a>>1):(a>>1))},encodeUnsignedInteger:function(a){var b,c="";while(a>=32){b=(32|(a&31))+63;c+=(String.fromCharCode(b));a>>=5}b=a+63;c+=(String.fromCharCode(b));return c},decodeUnsignedInteger:function(g){var c=0;var d=0;var f=g.length;for(var e=0;e<f;++e){var a=g.charCodeAt(e)-63;c|=(a&31)<<d;if(a<32){break}d+=5}return c},CLASS_NAME:"OpenLayers.Format.EncodedPolyline"});