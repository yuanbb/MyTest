OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},xy:true,defaultPrefix:"xls",schemaLocation:null,read:function(c,a){a=OpenLayers.Util.applyDefaults(a,this.options);var b={};this.readChildNodes(c,b);return b},readers:{xls:{XLS:function(b,a){a.version=b.getAttribute("version");this.readChildNodes(b,a)},Response:function(b,a){this.readChildNodes(b,a)},GeocodeResponse:function(b,a){a.responseLists=[];this.readChildNodes(b,a)},GeocodeResponseList:function(c,b){var a={features:[],numberOfGeocodedAddresses:parseInt(c.getAttribute("numberOfGeocodedAddresses"))};b.responseLists.push(a);this.readChildNodes(c,a)},GeocodedAddress:function(c,b){var a=new OpenLayers.Feature.Vector();b.features.push(a);this.readChildNodes(c,a);a.geometry=a.components[0]},GeocodeMatchCode:function(b,a){a.attributes.matchCode={accuracy:parseFloat(b.getAttribute("accuracy")),matchType:b.getAttribute("matchType")}},Address:function(c,b){var a={countryCode:c.getAttribute("countryCode"),addressee:c.getAttribute("addressee"),street:[],place:[]};b.attributes.address=a;this.readChildNodes(c,a)},freeFormAddress:function(b,a){a.freeFormAddress=this.getChildValue(b)},StreetAddress:function(b,a){this.readChildNodes(b,a)},Building:function(b,a){a.building={number:b.getAttribute("number"),subdivision:b.getAttribute("subdivision"),buildingName:b.getAttribute("buildingName")}},Street:function(b,a){a.street.push(this.getChildValue(b))},Place:function(b,a){a.place[b.getAttribute("type")]=this.getChildValue(b)},PostalCode:function(b,a){a.postalCode=this.getChildValue(b)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(a){return this.writers.xls.XLS.apply(this,[a])},writers:{xls:{XLS:function(b){var a=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});this.writeNode("RequestHeader",b.header,a);this.writeNode("Request",b,a);return a},RequestHeader:function(a){return this.createElementNSPlus("xls:RequestHeader")},Request:function(b){var a=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:b.requestID||"",version:this.VERSION}});this.writeNode("GeocodeRequest",b.addresses,a);return a},GeocodeRequest:function(d){var c=this.createElementNSPlus("xls:GeocodeRequest");for(var b=0,a=d.length;b<a;b++){this.writeNode("Address",d[b],c)}return c},Address:function(a){var b=this.createElementNSPlus("xls:Address",{attributes:{countryCode:a.countryCode}});if(a.freeFormAddress){this.writeNode("freeFormAddress",a.freeFormAddress,b)}else{if(a.street){this.writeNode("StreetAddress",a,b)}if(a.municipality){this.writeNode("Municipality",a.municipality,b)}if(a.countrySubdivision){this.writeNode("CountrySubdivision",a.countrySubdivision,b)}if(a.postalCode){this.writeNode("PostalCode",a.postalCode,b)}}return b},freeFormAddress:function(a){return this.createElementNSPlus("freeFormAddress",{value:a})},StreetAddress:function(b){var d=this.createElementNSPlus("xls:StreetAddress");if(b.building){this.writeNode(d,"Building",b.building)}var e=b.street;if(!(OpenLayers.Util.isArray(e))){e=[e]}for(var c=0,a=e.length;c<a;c++){this.writeNode("Street",e[c],d)}return d},Building:function(a){return this.createElementNSPlus("xls:Building",{attributes:{number:a.number,subdivision:a.subdivision,buildingName:a.buildingName}})},Street:function(a){return this.createElementNSPlus("xls:Street",{value:a})},Municipality:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"Municipality"},value:a})},CountrySubdivision:function(a){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:a})},PostalCode:function(a){return this.createElementNSPlus("xls:PostalCode",{value:a})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"});