OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:false,pinching:false,last:null,start:null,touchstart:function(b){var a=true;this.pinching=false;if(OpenLayers.Event.isMultiTouch(b)){this.started=true;this.last=this.start={distance:this.getDistance(b.touches),delta:0,scale:1};this.callback("start",[b,this.start]);a=!this.stopDown}else{if(this.started){return false}else{this.started=false;this.start=null;this.last=null}}OpenLayers.Event.preventDefault(b);return a},touchmove:function(a){if(this.started&&OpenLayers.Event.isMultiTouch(a)){this.pinching=true;var b=this.getPinchData(a);this.callback("move",[a,b]);this.last=b;OpenLayers.Event.stop(a)}else{if(this.started){return false}}return true},touchend:function(a){if(this.started&&!OpenLayers.Event.isMultiTouch(a)){this.started=false;this.pinching=false;this.callback("done",[a,this.start,this.last]);this.start=null;this.last=null;return false}return true},activate:function(){var a=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.pinching=false;a=true}return a},deactivate:function(){var a=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.pinching=false;this.start=null;this.last=null;a=true}return a},getDistance:function(c){var b=c[0];var a=c[1];return Math.sqrt(Math.pow(b.olClientX-a.olClientX,2)+Math.pow(b.olClientY-a.olClientY,2))},getPinchData:function(a){var c=this.getDistance(a.touches);var b=c/this.start.distance;return{distance:c,delta:this.last.distance-c,scale:b}},CLASS_NAME:"OpenLayers.Handler.Pinch"});