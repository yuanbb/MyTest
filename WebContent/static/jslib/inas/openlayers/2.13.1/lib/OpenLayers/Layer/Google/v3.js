OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:true,projection:"EPSG:900913"},animationEnabled:true,loadMapObject:function(){if(!this.type){this.type=google.maps.MapTypeId.ROADMAP}var e;var d=OpenLayers.Layer.Google.cache[this.map.id];if(d){e=d.mapObject;++d.count}else{var a=this.map.getCenter();var c=document.createElement("div");c.className="olForeignContainer";c.style.width="100%";c.style.height="100%";e=new google.maps.Map(c,{center:a?new google.maps.LatLng(a.lat,a.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false});var b=document.createElement("div");b.style.width="100%";b.style.height="100%";e.controls[google.maps.ControlPosition.TOP_LEFT].push(b);d={googleControl:b,mapObject:e,count:1};OpenLayers.Layer.Google.cache[this.map.id]=d}this.mapObject=e;this.setGMapVisibility(this.visibility)},onMapResize:function(){if(this.visibility){google.maps.event.trigger(this.mapObject,"resize")}},setGMapVisibility:function(d){var a=OpenLayers.Layer.Google.cache[this.map.id];var b=this.map;if(a){var j=this.type;var e=b.layers;var g;for(var f=e.length-1;f>=0;--f){g=e[f];if(g instanceof OpenLayers.Layer.Google&&g.visibility===true&&g.inRange===true){j=g.type;d=true;break}}var c=this.mapObject.getDiv();if(d===true){if(c.parentNode!==b.div){if(!a.rendered){var h=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){a.rendered=true;h.setGMapVisibility(h.getVisibility());h.moveTo(h.map.getCenter())})}else{b.div.appendChild(c);a.googleControl.appendChild(b.viewPortDiv);google.maps.event.trigger(this.mapObject,"resize")}}this.mapObject.setMapTypeId(j)}else{if(a.googleControl.hasChildNodes()){b.div.appendChild(b.viewPortDiv);b.div.removeChild(c)}}}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(c){var b=null;if(c!=null){var a=this.sphericalMercator?this.inverseMercator(c.bottom,c.left):new OpenLayers.LonLat(c.bottom,c.left);var d=this.sphericalMercator?this.inverseMercator(c.top,c.right):new OpenLayers.LonLat(c.top,c.right);b=new google.maps.LatLngBounds(new google.maps.LatLng(a.lat,a.lon),new google.maps.LatLng(d.lat,d.lon))}return b},getMapObjectLonLatFromMapObjectPixel:function(h){var b=this.map.getSize();var f=this.getLongitudeFromMapObjectLonLat(this.mapObject.center);var d=this.getLatitudeFromMapObjectLonLat(this.mapObject.center);var a=this.map.getResolution();var g=h.x-(b.w/2);var e=h.y-(b.h/2);var c=new OpenLayers.LonLat(f+g*a,d-e*a);if(this.wrapDateLine){c=c.wrapDateLine(this.maxExtent)}return this.getMapObjectLonLatFromLonLat(c.lon,c.lat)},getMapObjectPixelFromMapObjectLonLat:function(e){var d=this.getLongitudeFromMapObjectLonLat(e);var c=this.getLatitudeFromMapObjectLonLat(e);var a=this.map.getResolution();var b=this.map.getExtent();return this.getMapObjectPixelFromXY((1/a*(d-b.left)),(1/a*(b.top-c)))},setMapObjectCenter:function(a,c){if(this.animationEnabled===false&&c!=this.mapObject.zoom){var b=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){b.style.visibility=""});b.style.visibility="hidden"}this.mapObject.setOptions({center:a,zoom:c})},getMapObjectZoomFromMapObjectBounds:function(a){return this.mapObject.getBoundsZoomLevel(a)},getMapObjectLonLatFromLonLat:function(d,b){var c;if(this.sphericalMercator){var a=this.inverseMercator(d,b);c=new google.maps.LatLng(a.lat,a.lon)}else{c=new google.maps.LatLng(b,d)}return c},getMapObjectPixelFromXY:function(a,b){return new google.maps.Point(a,b)}};