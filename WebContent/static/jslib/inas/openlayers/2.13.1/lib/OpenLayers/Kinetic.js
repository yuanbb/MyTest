OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:0.0035,nbPoints:100,delay:200,points:undefined,timerId:undefined,initialize:function(a){OpenLayers.Util.extend(this,a)},begin:function(){OpenLayers.Animation.stop(this.timerId);this.timerId=undefined;this.points=[]},update:function(a){this.points.unshift({xy:a,tick:new Date().getTime()});if(this.points.length>this.nbPoints){this.points.pop()}},end:function(k){var j,a=new Date().getTime();for(var f=0,e=this.points.length,h;f<e;f++){h=this.points[f];if(a-h.tick>this.delay){break}j=h}if(!j){return}var d=new Date().getTime()-j.tick;var g=Math.sqrt(Math.pow(k.x-j.xy.x,2)+Math.pow(k.y-j.xy.y,2));var c=g/d;if(c==0||c<this.threshold){return}var b=Math.asin((k.y-j.xy.y)/g);if(j.xy.x<=k.x){b=Math.PI-b}return{speed:c,theta:b}},move:function(c,i){var h=c.speed;var f=Math.cos(c.theta);var e=-Math.sin(c.theta);var d=new Date().getTime();var b=0;var a=0;var g=function(){if(this.timerId==null){return}var m=new Date().getTime()-d;var n=(-this.deceleration*Math.pow(m,2))/2+h*m;var j=n*f;var o=n*e;var l={};l.end=false;var k=-this.deceleration*m+h;if(k<=0){OpenLayers.Animation.stop(this.timerId);this.timerId=null;l.end=true}l.x=j-b;l.y=o-a;b=j;a=o;i(l.x,l.y,l.end)};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(g,this))},CLASS_NAME:"OpenLayers.Kinetic"});