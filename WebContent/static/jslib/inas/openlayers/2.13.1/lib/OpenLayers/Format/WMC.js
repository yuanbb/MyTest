OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(c){var g=this.getParser();var e={queryable:c.queryable,visibility:c.visibility,name:c.params.LAYERS,title:c.name,"abstract":c.metadata["abstract"],dataURL:c.metadata.dataURL,metadataURL:c.metadataURL,server:{version:c.params.VERSION,url:c.url},maxExtent:c.maxExtent,transparent:c.params.TRANSPARENT,numZoomLevels:c.numZoomLevels,units:c.units,isBaseLayer:c.isBaseLayer,opacity:c.opacity==1?undefined:c.opacity,displayInLayerSwitcher:c.displayInLayerSwitcher,singleTile:c.singleTile,tileSize:(c.singleTile||!c.tileSize)?undefined:{width:c.tileSize.w,height:c.tileSize.h},minScale:(c.options.resolutions||c.options.scales||c.options.maxResolution||c.options.minScale)?c.minScale:undefined,maxScale:(c.options.resolutions||c.options.scales||c.options.minResolution||c.options.maxScale)?c.maxScale:undefined,formats:[],styles:[],srs:c.srs,dimensions:c.dimensions};if(c.metadata.servertitle){e.server.title=c.metadata.servertitle}if(c.metadata.formats&&c.metadata.formats.length>0){for(var b=0,a=c.metadata.formats.length;b<a;b++){var f=c.metadata.formats[b];e.formats.push({value:f.value,current:(f.value==c.params.FORMAT)})}}else{e.formats.push({value:c.params.FORMAT,current:true})}if(c.metadata.styles&&c.metadata.styles.length>0){for(var b=0,a=c.metadata.styles.length;b<a;b++){var d=c.metadata.styles[b];if((d.href==c.params.SLD)||(d.body==c.params.SLD_BODY)||(d.name==c.params.STYLES)){d.current=true}else{d.current=false}e.styles.push(d)}}else{e.styles.push({href:c.params.SLD,body:c.params.SLD_BODY,name:c.params.STYLES||g.defaultStyleName,title:g.defaultStyleTitle,current:true})}return e},toContext:function(g){var e={};var f=g.layers;if(g.CLASS_NAME=="OpenLayers.Map"){var d=g.metadata||{};e.size=g.getSize();e.bounds=g.getExtent();e.projection=g.projection;e.title=g.title;e.keywords=d.keywords;e["abstract"]=d["abstract"];e.logo=d.logo;e.descriptionURL=d.descriptionURL;e.contactInformation=d.contactInformation;e.maxExtent=g.maxExtent}else{OpenLayers.Util.applyDefaults(e,g);if(e.layers!=undefined){delete (e.layers)}}if(e.layersContext==undefined){e.layersContext=[]}if(f!=undefined&&OpenLayers.Util.isArray(f)){for(var c=0,a=f.length;c<a;c++){var b=f[c];if(b instanceof OpenLayers.Layer.WMS){e.layersContext.push(this.layerToContext(b))}}}return e},CLASS_NAME:"OpenLayers.Format.WMC"});