OpenLayers.Tile.Image.IFrame={useIFrame:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",draw:function(){var a=OpenLayers.Tile.Image.prototype.shouldDraw.call(this);if(a){var b=this.layer.getURL(this.bounds);var e=this.useIFrame;this.useIFrame=this.maxGetUrlLength!==null&&!this.layer.async&&b.length>this.maxGetUrlLength;var d=e&&!this.useIFrame;var c=!e&&this.useIFrame;if(d||c){if(this.imgDiv&&this.imgDiv.parentNode===this.frame){this.frame.removeChild(this.imgDiv)}this.imgDiv=null;if(d){this.frame.removeChild(this.frame.firstChild)}}}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(this.useIFrame===true){if(!this.frame.childNodes.length){var c=document.createElement("div"),b=c.style;b.position="absolute";b.width="100%";b.height="100%";b.zIndex=1;b.backgroundImage="url("+this.blankImageUrl+")";this.frame.appendChild(c)}var d=this.id+"_iFrame",a;if(parseFloat(navigator.appVersion.split("MSIE")[1])<9){a=document.createElement('<iframe name="'+d+'">');a.style.backgroundColor="#FFFFFF";a.style.filter="chroma(color=#FFFFFF)"}else{a=document.createElement("iframe");a.style.backgroundColor="transparent";a.name=d}a.scrolling="no";a.marginWidth="0px";a.marginHeight="0px";a.frameBorder="0";a.style.position="absolute";a.style.width="100%";a.style.height="100%";if(this.layer.opacity<1){OpenLayers.Util.modifyDOMElement(a,null,null,null,null,null,null,this.layer.opacity)}this.frame.appendChild(a);this.imgDiv=a;return a}else{return OpenLayers.Tile.Image.prototype.getImage.apply(this,arguments)}},createRequestForm:function(){var b=document.createElement("form");b.method="POST";var f=this.layer.params._OLSALT;f=(f?f+"_":"")+this.bounds.toBBOX();b.action=OpenLayers.Util.urlAppend(this.layer.url,f);b.target=this.id+"_iFrame";var c=this.layer.getImageSize(),e=OpenLayers.Util.getParameters(this.url),d;for(var a in e){d=document.createElement("input");d.type="hidden";d.name=a;d.value=e[a];b.appendChild(d)}return b},setImgSrc:function(a){if(this.useIFrame===true){if(a){var b=this.createRequestForm();this.frame.appendChild(b);b.submit();this.frame.removeChild(b)}else{if(this.imgDiv.parentNode===this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv=null}}}else{OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)}},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments);if(this.useIFrame===true){this.imgDiv.style.opacity=1;this.frame.style.opacity=this.layer.opacity}},createBackBuffer:function(){var a;if(this.useIFrame===false){a=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)}return a}};