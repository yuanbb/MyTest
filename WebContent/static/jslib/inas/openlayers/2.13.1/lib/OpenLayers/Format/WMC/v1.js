OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(a){var b=null;if(a==null){b=this.namespaces[this.defaultPrefix]}else{for(b in this.namespaces){if(this.namespaces[b]==a){break}}}return b},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(a){OpenLayers.Format.XML.prototype.initialize.apply(this,[a])},read:function(c){if(typeof c=="string"){c=OpenLayers.Format.XML.prototype.read.apply(this,[c])}var a=c.documentElement;this.rootPrefix=a.prefix;var b={version:a.getAttribute("version")};this.runChildNodes(b,a);return b},runChildNodes:function(e,d){var b=d.childNodes;var a,c,g,j;for(var f=0,h=b.length;f<h;++f){a=b[f];if(a.nodeType==1){g=this.getNamespacePrefix(a.namespaceURI);j=a.nodeName.split(":").pop();c=this["read_"+g+"_"+j];if(c){c.apply(this,[e,a])}}}},read_wmc_General:function(a,b){this.runChildNodes(a,b)},read_wmc_BoundingBox:function(a,b){a.projection=b.getAttribute("SRS");a.bounds=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"))},read_wmc_LayerList:function(a,b){a.layersContext=[];this.runChildNodes(a,b)},read_wmc_Layer:function(a,b){var c={visibility:(b.getAttribute("hidden")!="1"),queryable:(b.getAttribute("queryable")=="1"),formats:[],styles:[],metadata:{}};this.runChildNodes(c,b);a.layersContext.push(c)},read_wmc_Extension:function(b,a){this.runChildNodes(b,a)},read_ol_units:function(b,a){b.units=this.getChildValue(a)},read_ol_maxExtent:function(c,b){var a=new OpenLayers.Bounds(b.getAttribute("minx"),b.getAttribute("miny"),b.getAttribute("maxx"),b.getAttribute("maxy"));c.maxExtent=a},read_ol_transparent:function(b,a){b.transparent=this.getChildValue(a)},read_ol_numZoomLevels:function(b,a){b.numZoomLevels=parseInt(this.getChildValue(a))},read_ol_opacity:function(b,a){b.opacity=parseFloat(this.getChildValue(a))},read_ol_singleTile:function(b,a){b.singleTile=(this.getChildValue(a)=="true")},read_ol_tileSize:function(b,a){var c={width:a.getAttribute("width"),height:a.getAttribute("height")};b.tileSize=c},read_ol_isBaseLayer:function(b,a){b.isBaseLayer=(this.getChildValue(a)=="true")},read_ol_displayInLayerSwitcher:function(b,a){b.displayInLayerSwitcher=(this.getChildValue(a)=="true")},read_wmc_Server:function(b,a){b.version=a.getAttribute("version");b.url=this.getOnlineResource_href(a);b.metadata.servertitle=a.getAttribute("title")},read_wmc_FormatList:function(b,a){this.runChildNodes(b,a)},read_wmc_Format:function(b,a){var c={value:this.getChildValue(a)};if(a.getAttribute("current")=="1"){c.current=true}b.formats.push(c)},read_wmc_StyleList:function(b,a){this.runChildNodes(b,a)},read_wmc_Style:function(c,b){var a={};this.runChildNodes(a,b);if(b.getAttribute("current")=="1"){a.current=true}c.styles.push(a)},read_wmc_SLD:function(a,b){this.runChildNodes(a,b)},read_sld_StyledLayerDescriptor:function(c,b){var a=OpenLayers.Format.XML.prototype.write.apply(this,[b]);c.body=a},read_sld_FeatureTypeStyle:function(c,b){var a=OpenLayers.Format.XML.prototype.write.apply(this,[b]);c.body=a},read_wmc_OnlineResource:function(b,a){b.href=this.getAttributeNS(a,this.namespaces.xlink,"href")},read_wmc_Name:function(c,b){var a=this.getChildValue(b);if(a){c.name=a}},read_wmc_Title:function(b,a){var c=this.getChildValue(a);if(c){b.title=c}},read_wmc_MetadataURL:function(b,a){b.metadataURL=this.getOnlineResource_href(a)},read_wmc_KeywordList:function(a,b){a.keywords=[];this.runChildNodes(a.keywords,b)},read_wmc_Keyword:function(a,b){a.push(this.getChildValue(b))},read_wmc_Abstract:function(c,b){var a=this.getChildValue(b);if(a){c["abstract"]=a}},read_wmc_LogoURL:function(a,b){a.logo={width:b.getAttribute("width"),height:b.getAttribute("height"),format:b.getAttribute("format"),href:this.getOnlineResource_href(b)}},read_wmc_DescriptionURL:function(a,b){a.descriptionURL=this.getOnlineResource_href(b)},read_wmc_ContactInformation:function(c,b){var a={};this.runChildNodes(a,b);c.contactInformation=a},read_wmc_ContactPersonPrimary:function(b,c){var a={};this.runChildNodes(a,c);b.personPrimary=a},read_wmc_ContactPerson:function(b,c){var a=this.getChildValue(c);if(a){b.person=a}},read_wmc_ContactOrganization:function(b,c){var a=this.getChildValue(c);if(a){b.organization=a}},read_wmc_ContactPosition:function(b,c){var a=this.getChildValue(c);if(a){b.position=a}},read_wmc_ContactAddress:function(a,b){var c={};this.runChildNodes(c,b);a.contactAddress=c},read_wmc_AddressType:function(c,b){var a=this.getChildValue(b);if(a){c.type=a}},read_wmc_Address:function(c,b){var a=this.getChildValue(b);if(a){c.address=a}},read_wmc_City:function(c,a){var b=this.getChildValue(a);if(b){c.city=b}},read_wmc_StateOrProvince:function(c,a){var b=this.getChildValue(a);if(b){c.stateOrProvince=b}},read_wmc_PostCode:function(c,b){var a=this.getChildValue(b);if(a){c.postcode=a}},read_wmc_Country:function(c,a){var b=this.getChildValue(a);if(b){c.country=b}},read_wmc_ContactVoiceTelephone:function(a,c){var b=this.getChildValue(c);if(b){a.phone=b}},read_wmc_ContactFacsimileTelephone:function(a,c){var b=this.getChildValue(c);if(b){a.fax=b}},read_wmc_ContactElectronicMailAddress:function(a,c){var b=this.getChildValue(c);if(b){a.email=b}},read_wmc_DataURL:function(b,a){b.dataURL=this.getOnlineResource_href(a)},read_wmc_LegendURL:function(b,c){var a={width:c.getAttribute("width"),height:c.getAttribute("height"),format:c.getAttribute("format"),href:this.getOnlineResource_href(c)};b.legend=a},read_wmc_DimensionList:function(b,a){b.dimensions={};this.runChildNodes(b.dimensions,a)},read_wmc_Dimension:function(d,c){var b=c.getAttribute("name").toLowerCase();var e={name:b,units:c.getAttribute("units")||"",unitSymbol:c.getAttribute("unitSymbol")||"",userValue:c.getAttribute("userValue")||"",nearestValue:c.getAttribute("nearestValue")==="1",multipleValues:c.getAttribute("multipleValues")==="1",current:c.getAttribute("current")==="1","default":c.getAttribute("default")||""};var a=this.getChildValue(c);e.values=a.split(",");d[e.name]=e},write:function(c,b){var a=this.createElementDefaultNS("ViewContext");this.setAttributes(a,{version:this.VERSION,id:(b&&typeof b.id=="string")?b.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(a,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);a.appendChild(this.write_wmc_General(c));a.appendChild(this.write_wmc_LayerList(c));return OpenLayers.Format.XML.prototype.write.apply(this,[a])},createElementDefaultNS:function(c,b,a){var d=this.createElementNS(this.namespaces[this.defaultPrefix],c);if(b){d.appendChild(this.createTextNode(b))}if(a){this.setAttributes(d,a)}return d},setAttributes:function(b,d){var c;for(var a in d){c=d[a].toString();if(c.match(/[A-Z]/)){this.setAttributeNS(b,null,a,c)}else{b.setAttribute(a,c)}}},write_wmc_General:function(a){var c=this.createElementDefaultNS("General");if(a.size){c.appendChild(this.createElementDefaultNS("Window",null,{width:a.size.w,height:a.size.h}))}var b=a.bounds;c.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:b.left.toPrecision(18),miny:b.bottom.toPrecision(18),maxx:b.right.toPrecision(18),maxy:b.top.toPrecision(18),SRS:a.projection}));c.appendChild(this.createElementDefaultNS("Title",a.title));if(a.keywords){c.appendChild(this.write_wmc_KeywordList(a.keywords))}if(a["abstract"]){c.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]))}if(a.logo){c.appendChild(this.write_wmc_URLType("LogoURL",a.logo.href,a.logo))}if(a.descriptionURL){c.appendChild(this.write_wmc_URLType("DescriptionURL",a.descriptionURL))}if(a.contactInformation){c.appendChild(this.write_wmc_ContactInformation(a.contactInformation))}c.appendChild(this.write_ol_MapExtension(a));return c},write_wmc_KeywordList:function(c){var d=this.createElementDefaultNS("KeywordList");for(var b=0,a=c.length;b<a;b++){d.appendChild(this.createElementDefaultNS("Keyword",c[b]))}return d},write_wmc_ContactInformation:function(a){var b=this.createElementDefaultNS("ContactInformation");if(a.personPrimary){b.appendChild(this.write_wmc_ContactPersonPrimary(a.personPrimary))}if(a.position){b.appendChild(this.createElementDefaultNS("ContactPosition",a.position))}if(a.contactAddress){b.appendChild(this.write_wmc_ContactAddress(a.contactAddress))}if(a.phone){b.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",a.phone))}if(a.fax){b.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",a.fax))}if(a.email){b.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",a.email))}return b},write_wmc_ContactPersonPrimary:function(a){var b=this.createElementDefaultNS("ContactPersonPrimary");if(a.person){b.appendChild(this.createElementDefaultNS("ContactPerson",a.person))}if(a.organization){b.appendChild(this.createElementDefaultNS("ContactOrganization",a.organization))}return b},write_wmc_ContactAddress:function(b){var a=this.createElementDefaultNS("ContactAddress");if(b.type){a.appendChild(this.createElementDefaultNS("AddressType",b.type))}if(b.address){a.appendChild(this.createElementDefaultNS("Address",b.address))}if(b.city){a.appendChild(this.createElementDefaultNS("City",b.city))}if(b.stateOrProvince){a.appendChild(this.createElementDefaultNS("StateOrProvince",b.stateOrProvince))}if(b.postcode){a.appendChild(this.createElementDefaultNS("PostCode",b.postcode))}if(b.country){a.appendChild(this.createElementDefaultNS("Country",b.country))}return a},write_ol_MapExtension:function(b){var d=this.createElementDefaultNS("Extension");var c=b.maxExtent;if(c){var a=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(a,{minx:c.left.toPrecision(18),miny:c.bottom.toPrecision(18),maxx:c.right.toPrecision(18),maxy:c.top.toPrecision(18)});d.appendChild(a)}return d},write_wmc_LayerList:function(c){var d=this.createElementDefaultNS("LayerList");for(var b=0,a=c.layersContext.length;b<a;++b){d.appendChild(this.write_wmc_Layer(c.layersContext[b]))}return d},write_wmc_Layer:function(a){var b=this.createElementDefaultNS("Layer",null,{queryable:a.queryable?"1":"0",hidden:a.visibility?"0":"1"});b.appendChild(this.write_wmc_Server(a));b.appendChild(this.createElementDefaultNS("Name",a.name));b.appendChild(this.createElementDefaultNS("Title",a.title));if(a["abstract"]){b.appendChild(this.createElementDefaultNS("Abstract",a["abstract"]))}if(a.dataURL){b.appendChild(this.write_wmc_URLType("DataURL",a.dataURL))}if(a.metadataURL){b.appendChild(this.write_wmc_URLType("MetadataURL",a.metadataURL))}return b},write_wmc_LayerExtension:function(b){var d=this.createElementDefaultNS("Extension");var a=b.maxExtent;var h=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(h,{minx:a.left.toPrecision(18),miny:a.bottom.toPrecision(18),maxx:a.right.toPrecision(18),maxy:a.top.toPrecision(18)});d.appendChild(h);if(b.tileSize&&!b.singleTile){var j=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(j,b.tileSize);d.appendChild(j)}var g=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"];var c;for(var e=0,f=g.length;e<f;++e){c=this.createOLPropertyNode(b,g[e]);if(c){d.appendChild(c)}}return d},createOLPropertyNode:function(b,c){var a=null;if(b[c]!=null){a=this.createElementNS(this.namespaces.ol,"ol:"+c);a.appendChild(this.createTextNode(b[c].toString()))}return a},write_wmc_Server:function(b){var d=b.server;var c=this.createElementDefaultNS("Server");var a={service:"OGC:WMS",version:d.version};if(d.title){a.title=d.title}this.setAttributes(c,a);c.appendChild(this.write_wmc_OnlineResource(d.url));return c},write_wmc_URLType:function(f,b,a){var e=this.createElementDefaultNS(f);e.appendChild(this.write_wmc_OnlineResource(b));if(a){var d=["width","height","format"];for(var c=0;c<d.length;c++){if(d[c] in a){e.setAttribute(d[c],a[d[c]])}}}return e},write_wmc_DimensionList:function(e){var f=this.createElementDefaultNS("DimensionList");var d={name:true,units:true,unitSymbol:true,userValue:true};for(var h in e.dimensions){var b={};var g=e.dimensions[h];for(var c in g){if(typeof g[c]=="boolean"){b[c]=Number(g[c])}else{b[c]=g[c]}}var a="";if(b.values){a=b.values.join(",");delete b.values}f.appendChild(this.createElementDefaultNS("Dimension",a,b))}return f},write_wmc_FormatList:function(c){var d=this.createElementDefaultNS("FormatList");for(var b=0,a=c.formats.length;b<a;b++){var e=c.formats[b];d.appendChild(this.createElementDefaultNS("Format",e.value,(e.current&&e.current==true)?{current:"1"}:null))}return d},write_wmc_StyleList:function(e){var c=this.createElementDefaultNS("StyleList");var k=e.styles;if(k&&OpenLayers.Util.isArray(k)){var a;for(var d=0,f=k.length;d<f;d++){var l=k[d];var b=this.createElementDefaultNS("Style",null,(l.current&&l.current==true)?{current:"1"}:null);if(l.href){a=this.createElementDefaultNS("SLD");if(l.name){a.appendChild(this.createElementDefaultNS("Name",l.name))}if(l.title){a.appendChild(this.createElementDefaultNS("Title",l.title))}if(l.legend){a.appendChild(this.write_wmc_URLType("LegendURL",l.legend.href,l.legend))}var g=this.write_wmc_OnlineResource(l.href);a.appendChild(g);b.appendChild(a)}else{if(l.body){a=this.createElementDefaultNS("SLD");if(l.name){a.appendChild(this.createElementDefaultNS("Name",l.name))}if(l.title){a.appendChild(this.createElementDefaultNS("Title",l.title))}if(l.legend){a.appendChild(this.write_wmc_URLType("LegendURL",l.legend.href,l.legend))}var h=OpenLayers.Format.XML.prototype.read.apply(this,[l.body]);var j=h.documentElement;if(a.ownerDocument&&a.ownerDocument.importNode){j=a.ownerDocument.importNode(j,true)}a.appendChild(j);b.appendChild(a)}else{b.appendChild(this.createElementDefaultNS("Name",l.name));b.appendChild(this.createElementDefaultNS("Title",l.title));if(l["abstract"]){b.appendChild(this.createElementDefaultNS("Abstract",l["abstract"]))}if(l.legend){b.appendChild(this.write_wmc_URLType("LegendURL",l.legend.href,l.legend))}}}c.appendChild(b)}}return c},write_wmc_OnlineResource:function(a){var b=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(b,this.namespaces.xlink,"xlink:type","simple");this.setAttributeNS(b,this.namespaces.xlink,"xlink:href",a);return b},getOnlineResource_href:function(c){var b={};var a=c.getElementsByTagName("OnlineResource");if(a.length>0){this.read_wmc_OnlineResource(b,a[0])}return b.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"});